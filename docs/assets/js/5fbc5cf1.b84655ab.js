"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[624],{6439:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"api","title":"API reference","description":"Official API endpoints live at https://mc-pulse.vercel.app/api (no ports). The shape described here mirrors the hosted surface while covering what you get when you self-host.","source":"@site/docs/api.md","sourceDirName":".","slug":"/api","permalink":"/docs/api","draft":false,"unlisted":false,"editUrl":"https://github.com/Noobyetpro/mc-pulse/tree/main/docs/docs/api.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Adding webhooks","permalink":"/docs/getting-started/adding-webhooks"},"next":{"title":"API keys and webhooks","permalink":"/docs/webhooks"}}');var t=n(4848),i=n(8453);const o={sidebar_position:3},a="API reference",d={},c=[{value:"Common query parameters",id:"common-query-parameters",level:3},{value:"Status payload",id:"status-payload",level:3},{value:"Endpoints",id:"endpoints",level:2},{value:"GET <code>/api/status</code>",id:"get-apistatus",level:3},{value:"GET <code>/api/status/:type</code>",id:"get-apistatustype",level:3},{value:"POST <code>/api/notify</code> (alias: <code>/api/status/notify</code>)",id:"post-apinotify-alias-apistatusnotify",level:3},{value:"Error responses",id:"error-responses",level:2},{value:"Defaults and caching",id:"defaults-and-caching",level:2}];function l(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"api-reference",children:"API reference"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["Official API endpoints live at ",(0,t.jsx)(s.a,{href:"https://mc-pulse.vercel.app/api",children:"https://mc-pulse.vercel.app/api"})," (no ports). The shape described here mirrors the hosted surface while covering what you get when you self-host."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Base path: ",(0,t.jsx)(s.code,{children:"/api"})]}),"\n",(0,t.jsxs)(s.p,{children:["mc-pulse speaks JSON over HTTP. Query parameters are optional unless noted; sensible defaults are applied from your ",(0,t.jsx)(s.code,{children:".env"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"common-query-parameters",children:"Common query parameters"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"host"})," \u2014 target server host. Defaults to ",(0,t.jsx)(s.code,{children:"DEFAULT_SERVER_HOST"})," when omitted."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"port"})," \u2014 target port. Defaults to:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Java: ",(0,t.jsx)(s.code,{children:"DEFAULT_SERVER_PORT"})," (env)"]}),"\n",(0,t.jsxs)(s.li,{children:["Bedrock: ",(0,t.jsx)(s.code,{children:"19132"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"type"})," \u2014 ",(0,t.jsx)(s.code,{children:"java"})," (default) or ",(0,t.jsx)(s.code,{children:"bedrock"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"status-payload",children:"Status payload"}),"\n",(0,t.jsx)(s.p,{children:"Every status lookup returns the same shape:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "host": "arch.mc",\n  "port": 25565,\n  "type": "java",\n  "online": true,\n  "latencyMs": 68,\n  "playersOnline": 12,\n  "playersMax": 100,\n  "version": "1.21.1",\n  "motd": "Welcome to Arch SMP",\n  "checkedAt": "2025-01-01T12:00:00.000Z"\n}\n'})}),"\n",(0,t.jsx)(s.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,t.jsxs)(s.h3,{id:"get-apistatus",children:["GET ",(0,t.jsx)(s.code,{children:"/api/status"})]}),"\n",(0,t.jsxs)(s.p,{children:["Ping a server (Java by default). Accepts the common query parameters above. Java lookups are cached in Redis for ",(0,t.jsx)(s.code,{children:"CACHE_TTL_SECONDS"}),"."]}),"\n",(0,t.jsxs)(s.h3,{id:"get-apistatustype",children:["GET ",(0,t.jsx)(s.code,{children:"/api/status/:type"})]}),"\n",(0,t.jsxs)(s.p,{children:["Explicitly target ",(0,t.jsx)(s.code,{children:"java"})," or ",(0,t.jsx)(s.code,{children:"bedrock"})," via the path. Query parameters for host/port behave the same as ",(0,t.jsx)(s.code,{children:"/api/status"}),"."]}),"\n",(0,t.jsxs)(s.h3,{id:"post-apinotify-alias-apistatusnotify",children:["POST ",(0,t.jsx)(s.code,{children:"/api/notify"})," (alias: ",(0,t.jsx)(s.code,{children:"/api/status/notify"}),")"]}),"\n",(0,t.jsx)(s.p,{children:"Fetch status and broadcast it to every webhook registered to the provided API key."}),"\n",(0,t.jsx)(s.p,{children:"Headers:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"x-api-key: <KEY>"})," (preferred), or"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"Authorization: ApiKey <KEY>"})}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Query parameters: same as ",(0,t.jsx)(s.code,{children:"GET /api/status"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Response:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "status": {\n    "host": "arch.mc",\n    "port": 25565,\n    "type": "java",\n    "online": true,\n    "latencyMs": 68,\n    "playersOnline": 12,\n    "playersMax": 100,\n    "version": "1.21.1",\n    "motd": "Welcome to Arch SMP",\n    "checkedAt": "2025-01-01T12:00:00.000Z"\n  },\n  "deliveries": [\n    { "id": "hook_123", "url": "https://example.com/webhook", "ok": true, "status": 200 },\n    { "id": "hook_456", "url": "https://example.com/fail", "ok": false, "error": "..." }\n  ]\n}\n'})}),"\n",(0,t.jsx)(s.h2,{id:"error-responses",children:"Error responses"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"400"})," \u2014 invalid query/body; response includes a ",(0,t.jsx)(s.code,{children:"details"})," object describing the validation errors."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"401"})," \u2014 missing/invalid API key (for endpoints that require auth)."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"500"})," \u2014 unexpected error while pinging, querying Redis, or hitting the database."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"defaults-and-caching",children:"Defaults and caching"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Java lookups are cached in Redis with TTL ",(0,t.jsx)(s.code,{children:"CACHE_TTL_SECONDS"}),"; Bedrock lookups skip cache so you always get a fresh result."]}),"\n",(0,t.jsxs)(s.li,{children:["When ",(0,t.jsx)(s.code,{children:"host"})," or ",(0,t.jsx)(s.code,{children:"port"})," are omitted, the service falls back to the defaults configured in ",(0,t.jsx)(s.code,{children:".env"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Each status call upserts a ",(0,t.jsx)(s.code,{children:"Server"})," record and stores a ",(0,t.jsx)(s.code,{children:"StatusSnapshot"})," in Postgres so you can build history or analytics later."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var r=n(6540);const t={},i=r.createContext(t);function o(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);